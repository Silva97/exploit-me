OUTBIN ?= exploitme004
EME_CHALLENGE_FLAG := $(or $(EME_CHALLENGE_FLAG),EME{exploitme004})

CFLAGS = -Wall \
	-Werror \
	-std=c11 \
	-O2 \
	-D 'EME_CHALLENGE_FLAG="$(EME_CHALLENGE_FLAG)"' \
	-pthread \
	-I include \
	-I $(PWD)/../common/include \
	-fno-stack-protector \
	-z execstack \
	-no-pie

SRCLIST = $(wildcard \
	src/*.c \
	../common/src/server/*.c \
)

.PHONY: all static

all:
	$(CC) $(CFLAGS) $(SRCLIST) -o $(OUTBIN)

static: CFLAGS += --static
static: all
