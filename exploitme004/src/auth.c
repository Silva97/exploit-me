#include <stdio.h>
#include <string.h>
#include "server.h"

void callback_auth(callback_argument_t *argument)
{
  char login[32];
  char passwd[32];

  client_printf(argument->client, "Login: ");
  client_read(argument->client, 311, login);

  client_printf(argument->client, "Password: ");
  client_read(argument->client, 31, passwd);

  if (strcmp(login, "admin") || strcmp(passwd, EME_CHALLENGE_FLAG))
  {
    client_printf(argument->client, "Invalid credentials!\n");
    return;
  }

  client_send(argument->client, sizeof EME_CHALLENGE_FLAG, EME_CHALLENGE_FLAG);
}
