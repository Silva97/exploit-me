FROM gcc:12.1.0 AS builder
ARG CRACKME_NAME

WORKDIR /app/${CRACKME_NAME}

COPY common /app/common
COPY ${CRACKME_NAME} /app/${CRACKME_NAME}
RUN OUTBIN=/app/the-crackme make static


FROM alpine:3.16.0
EXPOSE 1337
WORKDIR /app

COPY --from=builder /app/the-crackme ./the-crackme

CMD ["./the-crackme"]
