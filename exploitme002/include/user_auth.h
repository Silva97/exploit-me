#ifndef _USER_AUTH_H
#define _USER_AUTH_H

#include "server.h"

#define MSG_WRONG_PASSWORD_PREFIX "Wrong password to '"
#define MSG_WRONG_PASSWORD_SUFFIX "' credential!\n"
#define MSG_WRONG_LOGIN_PREFIX "Your credential '"
#define MSG_WRONG_LOGIN_SUFFIX "' is invalid!\n"

#define CLIENT_READ_OR_RETURN(client, size, buffer) \
  if (client_read(client, size, buffer) == -1)      \
  {                                                 \
    return;                                         \
  }

typedef struct credentials
{
  char login[32];
  char password[32];
} credentials_t;

void auth_init(void);
void callback_auth(callback_argument_t *argument);

#endif /* _USER_AUTH_H */
