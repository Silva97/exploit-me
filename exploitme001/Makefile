OUTBIN ?= exploitme001
EME_CHALLENGE_FLAG := $(or $(EME_CHALLENGE_FLAG),EME{exploitme001})

CFLAGS = -Wall \
	-Werror \
	-std=c11 \
	-O2 \
	-D 'EME_CHALLENGE_FLAG="$(EME_CHALLENGE_FLAG)"' \
	-pthread \
	-I include \
	-I $(PWD)/../common/include

SRCLIST = $(wildcard \
	src/*.c \
	../common/src/server/*.c \
	../common/src/utils/random_string.c \
)

.PHONY: all static

all:
	$(CC) $(CFLAGS) $(SRCLIST) -o $(OUTBIN)

static: CFLAGS += --static
static: all
